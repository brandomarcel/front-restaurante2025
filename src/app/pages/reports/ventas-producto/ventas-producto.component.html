
<div class="container bg-primary-foreground mx-auto my-8 px-4 p-3" >


<div class="p-4 space-y-4">
  <!-- Filtros -->
  <div class="flex flex-col md:flex-row md:items-center md:space-x-4 space-y-2 md:space-y-0">
    <div>
      <label class="block text-sm font-medium text-gray-700">Desde</label>
      <input type="date" [(ngModel)]="fromDate"
        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm focus:ring-blue-500 focus:border-blue-500" />
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Hasta</label>
      <input type="date" [(ngModel)]="toDate"
        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm focus:ring-blue-500 focus:border-blue-500" />
    </div>
    <div class="mt-4 md:mt-6">
      <button (click)="cargarDatos()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition">
        Buscar
      </button>
    </div>
  </div>

  <button (click)="exportarExcel()" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition">
    Descargar Excel
  </button>


  <!-- Cargando -->
  <div *ngIf="loading" class="text-blue-600 font-medium">Cargando...</div>

  <!-- Tabla -->
  <div *ngIf="!loading && data.length" class="overflow-x-auto">

    <!-- Selector de cantidad por página -->
    <div class="flex items-center justify-between mb-3 text-sm">
      <div class="flex gap-2 items-center">
        <span class="text-gray-700">Mostrar:</span>
        <button *ngFor="let size of [20, 50, 100]" (click)="setPageSize(size)" [ngClass]="{
          'bg-blue-600 text-white': pageSize === size,
          'bg-white text-gray-700 border': pageSize !== size
        }" class="px-3 py-1 rounded border border-gray-300 hover:bg-blue-100 transition">
          {{ size }}
        </button>
        <button (click)="setPageSize(data.length)" [ngClass]="{
          'bg-blue-600 text-white': pageSize === data.length,
          'bg-white text-gray-700 border': pageSize !== data.length
        }" class="px-3 py-1 rounded border border-gray-300 hover:bg-blue-100 transition">
          Todos
        </button>
      </div>
      <div class="text-gray-600">
        Página <strong>{{ page }}</strong> de <strong>{{ totalPages }}</strong>
      </div>
    </div>

    <!-- Tabla -->
    <table class="min-w-full table-auto border border-gray-300">
      <thead class="bg-gray-100">
        <tr>

          <th *ngFor="let col of columns" class="px-4 py-2 border-b text-left text-sm font-semibold text-gray-700">
            {{ col.label }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of data | paginate: { itemsPerPage: pageSize, currentPage: page } ; index as i" class="hover:bg-gray-50">

          <td *ngFor="let col of columns" class="px-4 py-2 border-b text-sm">
            {{ row[col.fieldname] }}
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Paginador -->
    <div class="mt-4 flex justify-center">
      <pagination-controls (pageChange)="page = $event" previousLabel="Anterior"
        nextLabel="Siguiente"></pagination-controls>
    </div>

  </div>


  <div *ngIf="!loading && !data.length" class="text-gray-500">
    No se encontraron datos.
  </div>
</div>

</div>